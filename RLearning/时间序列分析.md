# 时间序列分析

随机时间序列
按时间顺序排列的一组随机变量$X_1, X_2, \dotsb, X_t, \dotsb$表示一个随机事件的随机序列，简记$\{X_i, t \in T \}$

观察值序列
用$\{ x_t, t = 1, 2, \dotsb, n \}$标识该随机序列的$n$个有序观察值，称之为序列长度为$n$的观察值序列

时间序列分析
对时间序列进行观察、研究，找寻它变化发展的规律，预测它将来的走势就是时间序列分析

- 观察值序列是随机时间序列的一个实现(一次抽样过程)
- 研究目的：解释随机时序的性质(总体分布、边缘分布、联合分布、均值、方差等)
- 研究方法：通过观察值序列的性质进行推断(通过可观测样本推断总体参数或者分布)

分析方法
- 频域分析
  - 傅里叶变换、最大熵普估计理论
  - 方法复杂、结果抽象
- 时域分析
  - 序列自相关
  - 具有一定的惯性

## 特征统计量
分布函数或者密度函数能完全描述一个随即标量的统计特征

**随机变量族**$\{ X_t \}$的所有统计特性完全由它们的联合分布函数或联合密度函数决定
$f(x,\mu,\sigma) = \frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{(x-\mu)^2}{2\sigma^2}}$ with $x \in R$
$X \sim N(\mu, \sigma^2)$

### 概率分布
对于时间序列$\{ X_t, t \in T \}$
任取正整数$m$，任取$t_1, t_2, \dotsb, t_m \in T$，则$m$维随机向量$(X_{t_1}, X_{t_2}, \dotsb, X_{t_m})$的联合概率分布定义为$F_{t_1,t_2,\dotsb,t_m}(x_1,x_2,\dotsb,x_m) = P(X_{t_1} \le x_1, X_{t_2} \le x_2, \dotsb, X_{t_m} \le x_m)$
由这些有限维分布函数构成的全体
$\{ F_{t_1,t_2,\dotsb,t_m(x_1,x_2,\dotsb,x_m), } \forall m \in 正整数, \forall t_1,t_2,\dotsb,t_m \in T}$称为时间序列$\{ X_t, t \in T \}$的概率分布族

### 局限性
一个时间序列的概率结构，被它的有限维分布族唯一决定
时间应用中，要得到序列的联合概率分布几乎不可能
联合概率分布通常涉及非常复杂的数学运算

### 解决方法
研究该序列的低阶性(均值、方差、自协方差、自相关系数，也成为特征统计量)

### 均值
对于时间序列$\{ X_t, t \in T \}$，任意时刻的序列值$X$都是一个随机变量，分布函数为$F_t(x)$，若满足$\int_{-\infin}^{\infty}xF_t(x) \lt \infin$
则一定存在某个常数$\mu_t$使得随机变量$X_t$总是在$\mu_t$附近随机波动，则$\mu_t$为序列$\{ X_t \}$在$t$时刻的均值函数，$\mu_t = E(X_t) = \int_{-\infin}^{\infty}xF_t(x)$
$t$取遍了所有观察时刻，就得到均值函数序列$\{ \mu_t, t \in T\}$

## 预处理
### 平稳性检验

ARIMA不平稳的就利用差分等方法转换成平稳的ARIMA

中国纱年产量序列自相关图，短期相关长期不相关，

### 纯随机性检验
定义：序列值间没有任何相关性，**过去的行为对将来的发展没有丝毫影响**，这种序列就成为纯随机序列，也成为白噪声序列。没有任何实际分析价值的序列。

平稳了还要排除它是白噪声

#### 图
只和自己有关

#### 假设检验
Q统计量
LB统计量

## 平稳序列建模
### AR
$y_t = \alpha + \phi_1y{t-1} + \dotsb + \phi_p y_{t-p} + e_t$

AR(k)就说明和k个之前的变量有关系

#### AR(1)
系数绝对值小于1，说明平稳

用OLS方法

看ACF，如果绝对值大于等于1就不平稳？，没有呈现出短期相关长期不相关，验证了前面的结论

#### AR(2)
B表示滞后的算子，写法不同而已，意思一样

#### PACF
偏自相关函数
不只是ACF了，
相当于求回归系数了

### MA
看它和残差有什么关系

ACF of MA(1)
只有0和1有值，0为1
k >= 2的时候就相关性就很小了$\rho_k = 0$

###
根据ACF的截断，计算MA的q值

### ARMA
只有AR的p值可能会比较大，只有MA的q值比较大
用ARMA两个值都会比较小，一般都是0、1、2

两种方法确定，可以暴力计算

## 非平稳序列建模
我们利用ARIMA
差分运算转换成平稳的
### 时间序列的分解
#### Wold分解定理

#### Cramer分解定理

### 差分运算
提取确定性趋势

做多少次差分取决于趋势部分的多项式是多少次的

周期性差分

要防止过差分

⾮线性可以转为线性，减少差分阶数

### ARIMA模型
三个hyper-param怎么选

### 疏系数模型

### 简单季节模型
对于时序模型需要forecast包
又有趋势又有周期性

`auto.arima`p、q都在0、1、2的情况下去做暴力搜索
P45结果显示最简单的AR(1)就很好

通过残差和预测来评价?
