# lty=1:2, col=c("blue","red"), cex=.7)
z <- data.frame(values = edu$Gross_Tertiary_Education_Enrollment)
# 高等教育总入学率直方图
ggplot() +
geom_histogram(data = z, aes(x = values, y = ..density..),
binwidth = 10, fill = "lightblue", color = "black") +
geom_density(data = z, aes(x = values, y = ..density..),
color = "red") +
geom_vline(data = z, aes(xintercept = mean(values),
color = "Mean"), linetype = "dashed") +
geom_vline(data = z, aes(xintercept = mean(values) - sqrt(var(values)),
color = "Lower SD"), linetype = "dashed") +
geom_vline(data = z, aes(xintercept = mean(values) + sqrt(var(values)),
color = "Upper SD"), linetype = "dashed") +
labs(title = "高等教育总入学率直方图",
x = "入学率", y = "频率") +
theme_minimal() +
scale_color_manual(values = c("black", "purple", "green"),
labels = c("Density", "Mean", "Standard Deviation"),
guide = guide_legend())
enroll_model <- lm(Gross_Tertiary_Education_Enrollment ~., data = edu[c(-1, -2, -3), ])
enroll_model <- lm(Gross_Tertiary_Education_Enrollment ~., data = edu[c(-1, -2, -3), ])
enroll_model$coefficients
edu[c(-1, -2, -3), ]
enroll_model <- lm(Gross_Tertiary_Education_Enrollment ~., data = edu[, -c(1:3)])
enroll_model$coefficients
enroll_model <- lm(Gross_Tertiary_Education_Enrollment ~., data = edu[, -c(1:3)])
enroll_model$coefficients
summary(enroll_model)
# 我们挑出具有显著性的变量重新进行建模
enroll_model <- lm(Gross_Tertiary_Education_Enrollment ~., data = edu[, c(Lower_Secondary_End_Proficiency_Math, Birth_Rate, Gross_Primary_Education_Enrollment, Unemployment_Rate)])
# 我们挑出具有显著性的变量重新进行建模
enroll_model <- lm(Gross_Tertiary_Education_Enrollment ~ Lower_Secondary_End_Proficiency_Math + Birth_Rate + Gross_Primary_Education_Enrollment + Gross_Primary_Education_Enrollment, data = edu)
enroll_model$coefficients
summary(enroll_model)
# 我们挑出具有显著性的变量重新进行建模
enroll_model <- lm(Gross_Tertiary_Education_Enrollment ~ Lower_Secondary_End_Proficiency_Math + Birth_Rate + Gross_Primary_Education_Enrollment + Unemployment_Rate, data = edu)
enroll_model$coefficients
summary(enroll_model)
ggplot(data = edu, aes(x = Lower_Secondary_End_Proficiency_Math, y = Gross_Tertiary_Education_Enrollment)) +
geom_point()
ggplot(data = edu, aes(x = Lower_Secondary_End_Proficiency_Math, y = Gross_Tertiary_Education_Enrollment)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE)
ggplot(data = edu, aes(x = Lower_Secondary_End_Proficiency_Math, y = Gross_Tertiary_Education_Enrollment)) +
geom_point() +
geom_smooth(method = "lm", se = T)
par(mfrow=c(2,2))
ggplot(data = edu, aes(x = Lower_Secondary_End_Proficiency_Math, y = Gross_Tertiary_Education_Enrollment)) +
geom_point() +
geom_smooth(method = "lm", se = T)
ggplot(data = edu, aes(x = Birth_Rate, y = Gross_Tertiary_Education_Enrollment)) +
geom_point() +
geom_smooth(method = "lm", se = T)
ggplot(data = edu, aes(x = Gross_Primary_Education_Enrollment, y = Gross_Tertiary_Education_Enrollment)) +
geom_point() +
geom_smooth(method = "lm", se = T)
ggplot(data = edu, aes(x = Unemployment_Rate, y = Gross_Tertiary_Education_Enrollment)) +
geom_point() +
geom_smooth(method = "lm", se = T)
ggplot(data = edu, aes(x = Lower_Secondary_End_Proficiency_Math, y = Gross_Tertiary_Education_Enrollment)) +
geom_point() +
geom_smooth(method = "lm", se = T) +
facet_wrap(~ ., nrow = 2, ncol = 2)
ggplot(data = edu, aes(x = Birth_Rate, y = Gross_Tertiary_Education_Enrollment)) +
geom_point() +
geom_smooth(method = "lm", se = T)
ggplot(data = edu, aes(x = Gross_Primary_Education_Enrollment, y = Gross_Tertiary_Education_Enrollment)) +
geom_point() +
geom_smooth(method = "lm", se = T)
ggplot(data = edu, aes(x = Unemployment_Rate, y = Gross_Tertiary_Education_Enrollment)) +
geom_point() +
geom_smooth(method = "lm", se = T)
ggplot(data = edu, aes(x = Lower_Secondary_End_Proficiency_Math, y = Gross_Tertiary_Education_Enrollment)) +
geom_point() +
geom_smooth(method = "lm", se = T) +
facet_wrap(~ ., nrow = 2, ncol = 2) +
ggplot(data = edu, aes(x = Birth_Rate, y = Gross_Tertiary_Education_Enrollment)) +
geom_point() +
geom_smooth(method = "lm", se = T)
ggplot() +
geom_point(data = edu, aes(x = Lower_Secondary_End_Proficiency_Math, y = Gross_Tertiary_Education_Enrollment)) +
geom_smooth(data = edu, aes(x = Lower_Secondary_End_Proficiency_Math, y = Gross_Tertiary_Education_Enrollment), method = "lm", se = TRUE) +
facet_wrap(~ ., nrow = 2, ncol = 2) +
theme(plot.margin = margin(0.5, 0.5, 0.5, 0.5)) +
ggplot() +
geom_point(data = edu, aes(x = Birth_Rate, y = Gross_Tertiary_Education_Enrollment)) +
geom_smooth(data = edu, aes(x = Birth_Rate, y = Gross_Tertiary_Education_Enrollment), method = "lm", se = TRUE) +
theme(plot.margin = margin(0.5, 0.5, 0.5, 0.5)) +
ggplot() +
geom_point(data = edu, aes(x = Gross_Primary_Education_Enrollment, y = Gross_Tertiary_Education_Enrollment)) +
geom_smooth(data = edu, aes(x = Gross_Primary_Education_Enrollment, y = Gross_Tertiary_Education_Enrollment), method = "lm", se = TRUE) +
theme(plot.margin = margin(0.5, 0.5, 0.5, 0.5)) +
ggplot() +
geom_point(data = edu, aes(x = Unemployment_Rate, y = Gross_Tertiary_Education_Enrollment)) +
geom_smooth(data = edu, aes(x = Unemployment_Rate, y = Gross_Tertiary_Education_Enrollment), method = "lm", se = TRUE) +
theme(plot.margin = margin(0.5, 0.5, 0.5, 0.5))
ggplot() +
geom_point(data = edu, aes(x = Lower_Secondary_End_Proficiency_Math, y = Gross_Tertiary_Education_Enrollment)) +
geom_smooth(data = edu, aes(x = Lower_Secondary_End_Proficiency_Math, y = Gross_Tertiary_Education_Enrollment), method = "lm", se = TRUE) +
facet_wrap(~ ., nrow = 2, ncol = 2) +
theme(plot.margin = margin(0.5, 0.5, 0.5, 0.5)) +
geom_point(data = edu, aes(x = Birth_Rate, y = Gross_Tertiary_Education_Enrollment)) +
geom_smooth(data = edu, aes(x = Birth_Rate, y = Gross_Tertiary_Education_Enrollment), method = "lm", se = TRUE) +
theme(plot.margin = margin(0.5, 0.5, 0.5, 0.5)) +
geom_point(data = edu, aes(x = Gross_Primary_Education_Enrollment, y = Gross_Tertiary_Education_Enrollment)) +
geom_smooth(data = edu, aes(x = Gross_Primary_Education_Enrollment, y = Gross_Tertiary_Education_Enrollment), method = "lm", se = TRUE) +
theme(plot.margin = margin(0.5, 0.5, 0.5, 0.5)) +
geom_point(data = edu, aes(x = Unemployment_Rate, y = Gross_Tertiary_Education_Enrollment)) +
geom_smooth(data = edu, aes(x = Unemployment_Rate, y = Gross_Tertiary_Education_Enrollment), method = "lm", se = TRUE) +
theme(plot.margin = margin(0.5, 0.5, 0.5, 0.5))
ggplot(data = edu, aes(x = Lower_Secondary_End_Proficiency_Math, y = Gross_Tertiary_Education_Enrollment)) +
geom_point() +
geom_smooth(method = "lm", se = T) +
facet_wrap(~ ., nrow = 2, ncol = 2) +
ggplot(data = edu, aes(x = Birth_Rate, y = Gross_Tertiary_Education_Enrollment)) +
geom_point() +
geom_smooth(method = "lm", se = T)
ggplot(data = edu, aes(x = Lower_Secondary_End_Proficiency_Math, y = Gross_Tertiary_Education_Enrollment)) +
geom_point() +
geom_smooth(method = "lm", se = T)
ggplot(data = edu, aes(x = Birth_Rate, y = Gross_Tertiary_Education_Enrollment)) +
geom_point() +
geom_smooth(method = "lm", se = T)
ggplot(data = edu, aes(x = Gross_Primary_Education_Enrollment, y = Gross_Tertiary_Education_Enrollment)) +
geom_point() +
geom_smooth(method = "lm", se = T)
ggplot(data = edu, aes(x = Unemployment_Rate, y = Gross_Tertiary_Education_Enrollment)) +
geom_point() +
geom_smooth(method = "lm", se = T)
qqPlot(enroll_model, simulate = T)
# 加载需要的包
library(dplyr)
library(ggplot2)
library(mice)
library(caret)
library(car)
rm(list = ls())
# 读取需要数据集
edu <- read.csv("education.csv", stringsAsFactors = F)
z <- data.frame(values = edu$Gross_Tertiary_Education_Enrollment)
# 高等教育总入学率直方图
ggplot() +
geom_histogram(data = z, aes(x = values, y = ..density..),
binwidth = 10, fill = "lightblue", color = "black") +
geom_density(data = z, aes(x = values, y = ..density..),
color = "red") +
geom_vline(data = z, aes(xintercept = mean(values),
color = "Mean"), linetype = "dashed") +
geom_vline(data = z, aes(xintercept = mean(values) - sqrt(var(values)),
color = "Lower SD"), linetype = "dashed") +
geom_vline(data = z, aes(xintercept = mean(values) + sqrt(var(values)),
color = "Upper SD"), linetype = "dashed") +
labs(title = "高等教育总入学率直方图",
x = "入学率", y = "频率") +
theme_minimal() +
scale_color_manual(values = c("black", "purple", "green"),
labels = c("Density", "Mean", "Standard Deviation"),
guide = guide_legend())
enroll_model <- lm(Gross_Tertiary_Education_Enrollment ~., data = edu[, -c(1:3)])
enroll_model$coefficients
summary(enroll_model)
ggplot(data = edu, aes(x = Lower_Secondary_End_Proficiency_Math, y = Gross_Tertiary_Education_Enrollment)) +
geom_point() +
geom_smooth(method = "lm", se = T)
ggplot(data = edu, aes(x = Birth_Rate, y = Gross_Tertiary_Education_Enrollment)) +
geom_point() +
geom_smooth(method = "lm", se = T)
ggplot(data = edu, aes(x = Gross_Primary_Education_Enrollment, y = Gross_Tertiary_Education_Enrollment)) +
geom_point() +
geom_smooth(method = "lm", se = T)
ggplot(data = edu, aes(x = Unemployment_Rate, y = Gross_Tertiary_Education_Enrollment)) +
geom_point() +
geom_smooth(method = "lm", se = T)
# 我们挑出具有显著性的变量重新进行建模
enroll_model <- lm(Gross_Tertiary_Education_Enrollment ~ Lower_Secondary_End_Proficiency_Math + Birth_Rate + Gross_Primary_Education_Enrollment + Unemployment_Rate, data = edu)
enroll_model$coefficients
summary(enroll_model)
qqPlot(enroll_model, simulate = T)
residplot <- function(fit, nbreaks=10) {
z <- rstudent(fit)
hist(z, breaks=nbreaks, freq=FALSE,
xlab="Studentized Residual",
main="Distribution of Errors")
rug(jitter(z), col="brown")
curve(dnorm(x, mean=mean(z), sd=sd(z)),
add=TRUE, col="blue", lwd=2)
lines(density(z)$x, density(z)$y,
col="red", lwd=2, lty=2)
legend("topright",
legend = c( "Normal Curve", "Kernel Density Curve"),
lty=1:2, col=c("blue","red"), cex=.7)
}
residplot(enroll_model)
# 出问题，均值不在0这
z <- data.frame(values = edu$Unemployment_Rate)
# 失业率直方图
ggplot() +
geom_histogram(data = z, aes(x = values, y = ..density..),
binwidth = 10, fill = "lightblue", color = "black") +
geom_density(data = z, aes(x = values, y = ..density..),
color = "red") +
geom_vline(data = z, aes(xintercept = mean(values),
color = "Mean"), linetype = "dashed") +
geom_vline(data = z, aes(xintercept = mean(values) - sqrt(var(values)),
color = "Lower SD"), linetype = "dashed") +
geom_vline(data = z, aes(xintercept = mean(values) + sqrt(var(values)),
color = "Upper SD"), linetype = "dashed") +
labs(title = "高等教育总入学率直方图",
x = "入学率", y = "频率") +
theme_minimal() +
scale_color_manual(values = c("black", "purple", "green"),
labels = c("Density", "Mean", "Standard Deviation"),
guide = guide_legend())
# 加载需要的包
library(dplyr)
library(ggplot2)
library(mice)
library(caret)
library(car)
rm(list = ls())
# 读取需要数据集
edu <- read.csv("education.csv", stringsAsFactors = F)
z <- data.frame(values = edu$Gross_Tertiary_Education_Enrollment)
# 高等教育总入学率直方图
ggplot() +
geom_histogram(data = z, aes(x = values, y = ..density..),
binwidth = 10, fill = "lightblue", color = "black") +
geom_density(data = z, aes(x = values, y = ..density..),
color = "red") +
geom_vline(data = z, aes(xintercept = mean(values),
color = "Mean"), linetype = "dashed") +
geom_vline(data = z, aes(xintercept = mean(values) - sqrt(var(values)),
color = "Lower SD"), linetype = "dashed") +
geom_vline(data = z, aes(xintercept = mean(values) + sqrt(var(values)),
color = "Upper SD"), linetype = "dashed") +
labs(title = "高等教育总入学率直方图",
x = "入学率", y = "频率") +
theme_minimal() +
scale_color_manual(values = c("black", "purple", "green"),
labels = c("Density", "Mean", "Standard Deviation"),
guide = guide_legend())
z <- data.frame(values = edu$Unemployment_Rate)
# 失业率直方图
ggplot() +
geom_histogram(data = z, aes(x = values, y = ..density..),
binwidth = 10, fill = "lightblue", color = "black") +
geom_density(data = z, aes(x = values, y = ..density..),
color = "red") +
geom_vline(data = z, aes(xintercept = mean(values),
color = "Mean"), linetype = "dashed") +
geom_vline(data = z, aes(xintercept = mean(values) - sqrt(var(values)),
color = "Lower SD"), linetype = "dashed") +
geom_vline(data = z, aes(xintercept = mean(values) + sqrt(var(values)),
color = "Upper SD"), linetype = "dashed") +
labs(title = "高等教育总入学率直方图",
x = "入学率", y = "频率") +
theme_minimal() +
scale_color_manual(values = c("black", "purple", "green"),
labels = c("Density", "Mean", "Standard Deviation"),
guide = guide_legend())
z <- data.frame(values = edu$Unemployment_Rate)
# 失业率直方图
ggplot() +
geom_histogram(data = z, aes(x = values, y = ..density..),
binwidth = 5, fill = "lightblue", color = "black") +
geom_density(data = z, aes(x = values, y = ..density..),
color = "red") +
geom_vline(data = z, aes(xintercept = mean(values),
color = "Mean"), linetype = "dashed") +
geom_vline(data = z, aes(xintercept = mean(values) - sqrt(var(values)),
color = "Lower SD"), linetype = "dashed") +
geom_vline(data = z, aes(xintercept = mean(values) + sqrt(var(values)),
color = "Upper SD"), linetype = "dashed") +
labs(title = "高等教育总入学率直方图",
x = "入学率", y = "频率") +
theme_minimal() +
scale_color_manual(values = c("black", "purple", "green"),
labels = c("Density", "Mean", "Standard Deviation"),
guide = guide_legend())
z <- data.frame(values = edu$Unemployment_Rate)
# 失业率直方图
ggplot() +
geom_histogram(data = z, aes(x = values, y = ..density..),
binwidth = 2, fill = "lightblue", color = "black") +
geom_density(data = z, aes(x = values, y = ..density..),
color = "red") +
geom_vline(data = z, aes(xintercept = mean(values),
color = "Mean"), linetype = "dashed") +
geom_vline(data = z, aes(xintercept = mean(values) - sqrt(var(values)),
color = "Lower SD"), linetype = "dashed") +
geom_vline(data = z, aes(xintercept = mean(values) + sqrt(var(values)),
color = "Upper SD"), linetype = "dashed") +
labs(title = "高等教育总入学率直方图",
x = "入学率", y = "频率") +
theme_minimal() +
scale_color_manual(values = c("black", "purple", "green"),
labels = c("Density", "Mean", "Standard Deviation"),
guide = guide_legend())
z <- data.frame(values = edu$Unemployment_Rate)
# 失业率直方图
ggplot() +
geom_histogram(data = z, aes(x = values, y = ..density..),
binwidth = 3, fill = "lightblue", color = "black") +
geom_density(data = z, aes(x = values, y = ..density..),
color = "red") +
geom_vline(data = z, aes(xintercept = mean(values),
color = "Mean"), linetype = "dashed") +
geom_vline(data = z, aes(xintercept = mean(values) - sqrt(var(values)),
color = "Lower SD"), linetype = "dashed") +
geom_vline(data = z, aes(xintercept = mean(values) + sqrt(var(values)),
color = "Upper SD"), linetype = "dashed") +
labs(title = "高等教育总入学率直方图",
x = "入学率", y = "频率") +
theme_minimal() +
scale_color_manual(values = c("black", "purple", "green"),
labels = c("Density", "Mean", "Standard Deviation"),
guide = guide_legend())
z <- data.frame(values = edu$Unemployment_Rate)
# 失业率直方图
ggplot() +
geom_histogram(data = z, aes(x = values, y = ..density..),
binwidth = 3, fill = "lightblue", color = "black") +
geom_density(data = z, aes(x = values, y = ..density..),
color = "red") +
geom_vline(data = z, aes(xintercept = mean(values),
color = "Mean"), linetype = "dashed") +
geom_vline(data = z, aes(xintercept = mean(values) - sqrt(var(values)),
color = "Lower SD"), linetype = "dashed") +
geom_vline(data = z, aes(xintercept = mean(values) + sqrt(var(values)),
color = "Upper SD"), linetype = "dashed") +
labs(title = "失业率直方图",
x = "失业率", y = "频率") +
theme_minimal() +
scale_color_manual(values = c("black", "purple", "green"),
labels = c("Density", "Mean", "Standard Deviation"),
guide = guide_legend())
z <- data.frame(values = edu$Unemployment_Rate)
# 失业率直方图
ggplot() +
geom_histogram(data = z, aes(x = values, y = ..density..),
binwidth = 3, fill = "lightblue", color = "black") +
geom_density(data = z, aes(x = values, y = ..density..),
color = "red") +
geom_vline(data = z, aes(xintercept = mean(values),
color = "Mean"), linetype = "dashed") +
geom_vline(data = z, aes(xintercept = mean(values) - sqrt(var(values)),
color = "Lower SD"), linetype = "dashed") +
geom_vline(data = z, aes(xintercept = mean(values) + sqrt(var(values)),
color = "Upper SD"), linetype = "dashed") +
labs(title = "失业率直方图",
x = "失业率", y = "频率") +
theme_minimal() +
scale_color_manual(values = c("black", "purple", "green"),
labels = c("Density", "Mean", "Standard Deviation"),
guide = guide_legend())
qqPlot(edu$Gross_Tertiary_Education_Enrollment)
qqPlot(edu$Unemployment_Rate)
unemploy_model <- lm(Unemployment_Rate ~., data = edu[, -c(1:3)])
unemploy_model$coefficients
summary(unemploy_model)
ggplot(data = edu, aes(x = Gross_Tertiary_Education_Enrollment, y = Unemployment_Rate)) +
geom_point() +
geom_smooth(method = "lm", se = T)
# 我们挑出具有显著性的变量重新进行建模
unemploy_model <- lm(Unemployment_Rate ~ Gross_Tertiary_Education_Enrollment, data = edu)
unemploy_model$coefficients
summary(unemploy_model)
ggplot(data = edu, aes(x = OOSR_Pre0Primary_Age_Male, y = Unemployment_Rate)) +
geom_point() +
geom_smooth(method = "lm", se = T)
ggplot(data = edu, aes(x = Gross_Tertiary_Education_Enrollment, y = Unemployment_Rate)) +
geom_point() +
geom_smooth(method = "lm", se = T)
# 我们挑出具有显著性的变量重新进行建模
unemploy_model <- lm(Unemployment_Rate ~ Gross_Tertiary_Education_Enrollment + OOSR_Pre0Primary_Age_Male, data = edu)
unemploy_model$coefficients
summary(unemploy_model)
# 我们挑出具有显著性的变量重新进行建模
unemploy_model <- lm(Unemployment_Rate ~ Gross_Tertiary_Education_Enrollment + OOSR_Pre0Primary_Age_Male + OOSR_Pre0Primary_Age_Female, data = edu)
unemploy_model$coefficients
summary(unemploy_model)
# 我们挑出具有显著性的变量重新进行建模
unemploy_model <- lm(Unemployment_Rate ~ Gross_Tertiary_Education_Enrollment + OOSR_Pre0Primary_Age_Male, data = edu)
unemploy_model$coefficients
summary(unemploy_model)
# 我们挑出具有显著性的变量重新进行建模
unemploy_model <- lm(Unemployment_Rate ~ Gross_Tertiary_Education_Enrollment + OOSR_Pre0Primary_Age_Male + OOSR_Upper_Secondary_Age_Male, data = edu)
unemploy_model$coefficients
summary(unemploy_model)
qqPlot(unemploy_model)
residplot(unemploy_model)
residplot <- function(fit, nbreaks=10) {
z <- rstudent(fit)
hist(z, breaks=nbreaks, freq=FALSE,
xlab="Studentized Residual",
main="Distribution of Errors")
rug(jitter(z), col="brown")
curve(dnorm(x, mean=mean(z), sd=sd(z)),
add=TRUE, col="blue", lwd=2)
lines(density(z)$x, density(z)$y,
col="red", lwd=2, lty=2)
legend("topright",
legend = c( "Normal Curve", "Kernel Density Curve"),
lty=1:2, col=c("blue","red"), cex=.7)
}
residplot(unemploy_model)
residplot(unemploy_model, 5)
residplot <- function(fit, nbreaks=10) {
z <- rstudent(fit)
hist(z, breaks=nbreaks, freq=FALSE,
xlab="Studentized Residual",
main="Distribution of Errors")
rug(jitter(z), col="brown")
curve(dnorm(x, mean=mean(z), sd=sd(z)),
add=TRUE, col="blue", lwd=2)
lines(density(z)$x, density(z)$y,
col="red", lwd=5, lty=2)
legend("topright",
legend = c( "Normal Curve", "Kernel Density Curve"),
lty=1:2, col=c("blue","red"), cex=.7)
}
# Akaike
intercept_only <- lm(Gross_Tertiary_Education_Enrollment ~ 1, data = edu)
all <- lm(Gross_Tertiary_Education_Enrollment~ ., data = edu)
res <- step(intercept_only, scope = formula(all), trace = 0)
res$anova
res$coefficients
# Akaike
intercept_only <- lm(Gross_Tertiary_Education_Enrollment ~ 1, data = edu)
all <- lm(Gross_Tertiary_Education_Enrollment~ ., data = edu[, -c(1,2,3)])
res <- step(intercept_only, scope = formula(all), trace = 0)
res$anova
res$coefficients
# Akaike
intercept_only <- lm(Gross_Tertiary_Education_Enrollment ~ 1, data = edu)
all <- lm(Gross_Tertiary_Education_Enrollment~ ., data = edu[, -c(1,2,3)])
forward <- step(intercept_only, direction = "forward", scope = formula(all), trace = 0)
forward$anova
forward$coefficients
# Akaike
intercept_only <- lm(Gross_Tertiary_Education_Enrollment ~ 1, data = edu)
all <- lm(Gross_Tertiary_Education_Enrollment~ ., data = edu[, -c(1,2,3)])
forward <- step(intercept_only, direction = "forward", scope = formula(all), trace = 0)
forward$anova
forward$coefficients
backward <- step(intercept_only, direction = "backward", scope = formula(all), trace = 0)
backward$anova
backward$coefficients
# Akaike
intercept_only <- lm(Gross_Tertiary_Education_Enrollment ~ 1, data = edu)
all <- lm(Gross_Tertiary_Education_Enrollment~ ., data = edu[, -c(1,2,3)])
forward <- step(intercept_only, direction = "forward", scope = formula(all), trace = 0)
forward$anova
forward$coefficients
intercept_only <- lm(Gross_Tertiary_Education_Enrollment ~ 1, data = edu)
all <- lm(Gross_Tertiary_Education_Enrollment~ ., data = edu[, -c(1,2,3)])
backward <- step(intercept_only, direction = "backward", scope = formula(all), trace = 0)
backward$anova
backward$coefficients
intercept_only <- lm(Gross_Tertiary_Education_Enrollment ~ 1, data = edu)
all <- lm(Gross_Tertiary_Education_Enrollment~ ., data = edu[, -c(1,2,3)])
backward <- step(intercept_only, direction = "both", scope = formula(all), trace = 0)
backward$anova
backward$coefficients
intercept_only <- lm(Unemployment_Rate ~ 1, data = edu)
all <- lm(Unemployment_Rate~ ., data = edu[, -c(1,2,3)])
forward <- step(intercept_only, direction = "forward", scope = formula(all), trace = 0)
forward$anova
forward$coefficients
intercept_only <- lm(Unemployment_Rate ~ 1, data = edu)
all <- lm(Unemployment_Rate~ ., data = edu[, -c(1,2,3)])
forward <- step(intercept_only, direction = "backward", scope = formula(all), trace = 0)
forward$anova
forward$coefficients
intercept_only <- lm(Unemployment_Rate ~ 1, data = edu)
all <- lm(Unemployment_Rate~ ., data = edu[, -c(1,2,3)])
forward <- step(intercept_only, scope = formula(all), trace = 0)
forward$anova
forward$coefficients
# Akaike
intercept_only <- lm(Gross_Tertiary_Education_Enrollment ~ 1, data = edu)
all <- lm(Gross_Tertiary_Education_Enrollment~ ., data = edu[, -c(1,2,3)])
forward <- step(intercept_only, scope = formula(all), trace = 0)
forward$anova
forward$coefficients
# 根据Akaike的建模
enroll_model <- lm(Gross_Tertiary_Education_Enrollment ~ Lower_Secondary_End_Proficiency_Math + Birth_Rate + Gross_Primary_Education_Enrollment + Unemployment_Rate + Grade_2_3_Proficiency_Math, data = edu)
enroll_model$coefficients
summary(enroll_model)
qqPlot(enroll_model, simulate = T)
residplot(enroll_model)
residplot <- function(fit, nbreaks=10) {
z <- rstudent(fit)
hist(z, breaks=nbreaks, freq=FALSE,
xlab="Studentized Residual",
main="Distribution of Errors")
rug(jitter(z), col="brown")
curve(dnorm(x, mean=mean(z), sd=sd(z)),
add=TRUE, col="blue", lwd=2)
lines(density(z)$x, density(z)$y,
col="red", lwd=2, lty=2)
legend("topright",
legend = c( "Normal Curve", "Kernel Density Curve"),
lty=1:2, col=c("blue","red"), cex=.7)
}
residplot(enroll_model)
unemploy_model <- lm(Unemployment_Rate ~ Completion_Rate_Lower_Secondary_Female + Gross_Primary_Education_Enrollment + OOSR_Pre0Primary_Age_Male + OOSR_Upper_Secondary_Age_Male + Gross_Tertiary_Education_Enrollment + Grade_2_3_Proficiency_Math + OOSR_Primary_Age_Male, data = edu)
unemploy_model$coefficients
summary(unemploy_model)
qqPlot(unemploy_model)
residplot(unemploy_model)
